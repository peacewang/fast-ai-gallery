# 中国朝代更迭动态演示系统 - 需求文档

## 1. 项目概述

### 1.1 项目目标
创建一个交互式、多模态的中国朝代更迭动态演示系统，从夏朝（约公元前2070年）到清朝（1912年），全面展示中国历史朝代的兴衰变迁。系统要求直观、美观，具备智能助手功能，通过生成式动效和丰富的交互方式，让用户沉浸式了解中国历史。

### 1.2 核心价值
- **教育性**：系统化展示中国历史朝代信息
- **交互性**：多模态交互，支持多种浏览方式
- **视觉性**：精美的动效和UI设计
- **智能性**：AI助手提供个性化历史解读

## 2. 功能需求

### 2.1 朝代数据模型

每个朝代包含以下信息：

```typescript
interface Dynasty {
  id: string;                    // 唯一标识符
  name: string;                  // 朝代名称
  startYear: number;             // 建立年份（公元前用负数）
  endYear: number;              // 灭亡年份
  founder: string;               // 开国皇帝/君主
  capital: string | string[];    // 都城（可能有多个）
  territory: {                   // 疆域信息
    description: string;         // 疆域描述
    mapCoordinates?: number[];   // 地图坐标（用于可视化）
  };
  majorEvents: Array<{           // 重要大事件
    year: number;                // 事件年份
    title: string;               // 事件标题
    description: string;         // 事件描述
    category: 'political' | 'military' | 'cultural' | 'economic' | 'social';
    impact: 'high' | 'medium' | 'low';  // 影响程度
  }>;
  declineReasons: Array<{        // 衰落原因
    reason: string;              // 原因描述
    category: 'internal' | 'external' | 'natural' | 'economic';
    severity: 'critical' | 'major' | 'minor';
  }>;
  fallDetails: {                 // 灭亡详情
    year: number;                // 灭亡年份
    cause: string;               // 灭亡原因
    successor: string;           // 后继朝代
  };
  culturalAchievements?: string[]; // 文化成就
  notableFigures?: Array<{       // 著名人物
    name: string;
    role: string;
    period: string;
  }>;
  color: string;                  // 朝代主题色（用于UI）
  icon: string;                   // 朝代图标标识
}
```

### 2.2 朝代列表（完整版）

#### 2.2.1 主要朝代
1. **夏朝** (约公元前2070年 - 约公元前1600年)
2. **商朝** (约公元前1600年 - 约公元前1046年)
3. **周朝** (约公元前1046年 - 公元前256年)
   - 西周 (约公元前1046年 - 公元前771年)
   - 东周 (公元前770年 - 公元前256年)
     - 春秋时期 (公元前770年 - 公元前476年)
     - 战国时期 (公元前475年 - 公元前221年)
4. **秦朝** (公元前221年 - 公元前207年)
5. **汉朝** (公元前202年 - 220年)
   - 西汉 (公元前202年 - 9年)
   - 新朝 (9年 - 23年)
   - 东汉 (25年 - 220年)
6. **三国** (220年 - 280年)
   - 魏 (220年 - 265年)
   - 蜀汉 (221年 - 263年)
   - 吴 (222年 - 280年)
7. **晋朝** (265年 - 420年)
   - 西晋 (265年 - 316年)
   - 东晋 (317年 - 420年)
8. **南北朝** (420年 - 589年)
   - 南朝：宋、齐、梁、陈
   - 北朝：北魏、东魏、西魏、北齐、北周
9. **隋朝** (581年 - 618年)
10. **唐朝** (618年 - 907年)
11. **五代十国** (907年 - 979年)
12. **宋朝** (960年 - 1279年)
    - 北宋 (960年 - 1127年)
    - 南宋 (1127年 - 1279年)
13. **辽朝** (916年 - 1125年)
14. **金朝** (1115年 - 1234年)
15. **元朝** (1271年 - 1368年)
16. **明朝** (1368年 - 1644年)
17. **清朝** (1644年 - 1912年)

### 2.3 核心功能模块

#### 2.3.1 多视图切换系统
支持四种主要视图模式，用户可自由切换：

**A. 时间轴视图 (Timeline View)**
- 垂直时间轴，从下往上展示朝代更迭
- 每个朝代显示为时间轴上的一个节点
- 节点大小反映朝代持续时间
- 支持缩放：总览模式 / 详细模式
- 点击节点展开详细信息
- 支持时间轴滚动和跳转

**B. 卡片流视图 (Card Flow View)**
- 横向或纵向卡片流布局
- 每个朝代一张精美卡片
- 支持滑动切换（类似轮播图）
- 卡片包含：朝代名称、时间范围、开国皇帝、都城、主题色
- 点击卡片进入详情页

**C. 地图视图 (Map View)**
- 中国地图背景
- 显示各朝代疆域范围（用不同颜色区分）
- 显示都城位置（可切换显示不同时期的都城）
- 支持时间轴控制，动态展示疆域变化
- 点击疆域区域查看对应朝代信息

**D. 关系图视图 (Relationship Graph View)**
- 网络图形式展示朝代更迭关系
- 节点表示朝代，连线表示更迭关系
- 节点大小表示朝代重要性或持续时间
- 支持拖拽、缩放、高亮路径
- 点击节点查看详情

#### 2.3.2 朝代详情面板
当用户选择某个朝代时，显示详细信息面板：

**基本信息区**
- 朝代名称（大标题，使用朝代主题色）
- 时间范围（起止年份，持续时间计算）
- 开国皇帝（头像、姓名、简介）
- 都城信息（可切换显示不同时期的都城）
- 朝代主题色和图标

**重要大事件时间线**
- 垂直时间线展示该朝代的重要事件
- 事件按时间顺序排列
- 每个事件显示：年份、标题、描述、类别图标
- 支持筛选：按类别（政治、军事、文化、经济、社会）
- 支持按影响程度筛选
- 点击事件查看详细描述

**衰落原因分析**
- 卡片式展示多个衰落原因
- 每个原因标注类别和严重程度
- 使用可视化图表展示原因权重
- 支持展开查看详细分析

**灭亡详情**
- 灭亡年份和原因
- 灭亡过程描述
- 后继朝代信息（带链接跳转）

**文化成就展示**
- 网格布局展示文化成就
- 每个成就包含图标和描述
- 支持展开查看详细内容

**著名人物**
- 人物卡片展示
- 包含姓名、角色、活跃时期
- 点击查看人物详情

#### 2.3.3 智能助手 UI
**助手功能**
- 浮动助手按钮（右下角）
- 点击展开对话面板
- 支持以下交互：
  - 问答：回答关于朝代的问题
  - 推荐：根据用户浏览历史推荐相关内容
  - 对比：对比两个朝代的异同
  - 解释：解释历史概念和术语
  - 故事：讲述历史故事和趣闻

**助手界面设计**
- 毛玻璃效果面板
- 对话气泡样式
- 支持语音输入（可选）
- 支持文字输入
- 显示思考动画
- 支持复制回答内容

**助手能力**
- 理解自然语言问题
- 上下文感知（知道用户当前查看的朝代）
- 提供个性化建议
- 生成对比图表
- 推荐相关朝代

#### 2.3.4 生成式动效系统

**页面级动效**
- 页面加载：朝代卡片依次飞入
- 视图切换：平滑过渡动画
- 朝代切换：淡入淡出 + 缩放效果

**交互动效**
- 卡片悬停：3D翻转效果
- 按钮点击：涟漪扩散效果
- 时间轴滚动：视差滚动效果
- 地图缩放：平滑缩放动画

**数据可视化动效**
- 时间轴节点：呼吸灯效果
- 疆域变化：渐变动画展示
- 事件时间线：从下往上依次出现
- 图表数据：数据加载动画

**背景动效**
- 动态背景：根据当前朝代主题色变化
- 粒子效果：朝代切换时的粒子爆炸
- 光效：重要事件的高光效果

#### 2.3.5 搜索与筛选功能

**搜索功能**
- 全局搜索框（顶部）
- 支持搜索：朝代名称、皇帝姓名、都城、事件关键词
- 实时搜索结果高亮
- 支持历史搜索记录

**筛选功能**
- 按时间范围筛选
- 按朝代类型筛选（统一朝代 / 分裂时期）
- 按事件类别筛选
- 按影响程度筛选
- 多条件组合筛选

#### 2.3.6 对比功能
- 支持选择2-3个朝代进行对比
- 对比维度：
  - 时间跨度
  - 疆域范围
  - 重要事件数量
  - 文化成就
  - 衰落原因
- 对比结果以表格和图表形式展示

## 3. UI/UX 设计规范

### 3.1 设计风格
- **整体风格**：现代简约 + 中国风元素
- **色彩方案**：深色主题为主，支持浅色主题切换
- **字体**：中文使用思源黑体/苹方，英文使用系统字体
- **图标**：使用 Lucide React 图标库，部分自定义中国风图标

### 3.2 布局结构

```
┌─────────────────────────────────────────┐
│  顶部导航栏                              │
│  [Logo] [搜索] [视图切换] [设置] [助手]  │
├─────────────────────────────────────────┤
│                                         │
│          主内容区域                      │
│    (根据选择的视图显示不同内容)          │
│                                         │
│                                         │
├─────────────────────────────────────────┤
│  底部信息栏                              │
│  [当前朝代] [时间轴控制] [快捷操作]      │
└─────────────────────────────────────────┘
```

### 3.3 组件设计规范

**卡片组件**
- 圆角：16px
- 阴影：多层阴影营造层次感
- 悬停效果：轻微上浮 + 阴影加深
- 过渡动画：300ms ease-out

**按钮组件**
- 主要按钮：使用朝代主题色
- 次要按钮：半透明背景
- 图标按钮：圆形，毛玻璃效果
- 悬停效果：背景色加深 + 轻微缩放

**时间轴组件**
- 轴线：渐变色彩，粗细 3px
- 节点：圆形，大小根据重要性变化
- 标签：悬浮显示，毛玻璃背景
- 连接线：平滑曲线

**地图组件**
- 地图样式：简化版中国地图
- 疆域填充：使用朝代主题色，透明度 0.3
- 边界线：朝代主题色，粗细 2px
- 都城标记：特殊图标，可点击

### 3.4 响应式设计
- **桌面端** (≥1024px)：完整功能，多列布局
- **平板端** (768px - 1023px)：适配布局，保留核心功能
- **移动端** (<768px)：单列布局，简化交互

## 4. 技术实现方案

### 4.1 技术栈
- **框架**：Next.js 16 (App Router)
- **UI库**：React 19 + TypeScript
- **样式**：Tailwind CSS 4
- **动画**：Framer Motion / CSS Animations
- **图表**：Recharts / D3.js (用于数据可视化)
- **地图**：Leaflet / 自定义SVG地图
- **状态管理**：React Context + useReducer
- **数据存储**：本地JSON文件（可扩展为API）

### 4.2 文件结构

```
src/app/dynasty/
├── page.tsx                    # 主页面组件
├── demo.json                    # 首页元数据
├── cover.png                    # 封面图
├── components/
│   ├── TimelineView.tsx        # 时间轴视图
│   ├── CardFlowView.tsx        # 卡片流视图
│   ├── MapView.tsx             # 地图视图
│   ├── RelationshipGraphView.tsx # 关系图视图
│   ├── DynastyDetailPanel.tsx  # 朝代详情面板
│   ├── EventTimeline.tsx       # 事件时间线
│   ├── AIAssistant.tsx         # 智能助手
│   ├── SearchBar.tsx           # 搜索栏
│   ├── FilterPanel.tsx         # 筛选面板
│   ├── ComparisonPanel.tsx     # 对比面板
│   └── ViewSwitcher.tsx        # 视图切换器
├── data/
│   └── dynasties.json          # 朝代数据
├── hooks/
│   ├── useDynastyData.ts       # 数据获取Hook
│   ├── useViewMode.ts          # 视图模式Hook
│   └── useAIAssistant.ts       # AI助手Hook
├── utils/
│   ├── dateUtils.ts            # 日期工具函数
│   ├── mapUtils.ts             # 地图工具函数
│   └── animationUtils.ts       # 动画工具函数
└── styles/
    └── dynasty.module.css      # 样式文件
```

### 4.3 数据模型设计

**朝代数据文件结构** (`dynasties.json`)
```json
{
  "dynasties": [
    {
      "id": "xia",
      "name": "夏朝",
      "startYear": -2070,
      "endYear": -1600,
      "founder": "禹",
      "capital": ["阳城", "斟鄩"],
      "territory": {
        "description": "主要位于黄河流域中下游地区",
        "mapCoordinates": []
      },
      "majorEvents": [
        {
          "year": -2070,
          "title": "大禹治水",
          "description": "大禹成功治理洪水，奠定夏朝建立基础",
          "category": "political",
          "impact": "high"
        }
      ],
      "declineReasons": [
        {
          "reason": "末代君主夏桀暴政",
          "category": "internal",
          "severity": "critical"
        }
      ],
      "fallDetails": {
        "year": -1600,
        "cause": "商汤伐桀",
        "successor": "商朝"
      },
      "culturalAchievements": [
        "建立世袭制",
        "制定历法"
      ],
      "notableFigures": [
        {
          "name": "大禹",
          "role": "开国君主",
          "period": "约公元前2070年"
        }
      ],
      "color": "#8B4513",
      "icon": "crown"
    }
  ]
}
```

## 5. 交互流程设计

### 5.1 主要用户流程

**流程1：浏览朝代时间轴**
1. 用户进入页面，默认显示时间轴视图
2. 时间轴自动滚动到当前查看位置
3. 用户滚动时间轴，查看不同朝代
4. 点击某个朝代节点，展开详情面板
5. 在详情面板中查看该朝代的详细信息
6. 可以点击"下一个朝代"或"上一个朝代"快速切换

**流程2：使用智能助手**
1. 用户点击右下角助手按钮
2. 助手面板展开
3. 用户输入问题："唐朝为什么衰落？"
4. 助手分析问题，显示思考动画
5. 助手返回详细回答，包含相关事件链接
6. 用户可以继续提问或关闭面板

**流程3：对比朝代**
1. 用户在时间轴或卡片视图中选择第一个朝代
2. 点击"添加到对比"
3. 选择第二个朝代，再次点击"添加到对比"
4. 系统显示对比面板
5. 用户查看两个朝代的对比结果
6. 可以添加第三个朝代或清除对比

**流程4：搜索功能**
1. 用户在顶部搜索框输入关键词："长安"
2. 实时显示搜索结果
3. 结果高亮显示匹配的朝代和相关信息
4. 用户点击结果，跳转到对应朝代详情

### 5.2 交互细节

**手势支持**
- 桌面端：鼠标悬停、点击、拖拽
- 移动端：滑动、长按、双击

**键盘快捷键**
- `←/→`：切换上一个/下一个朝代
- `Space`：播放/暂停时间轴动画
- `F`：全屏模式
- `S`：打开搜索
- `A`：打开助手
- `Esc`：关闭当前面板

**动画时长规范**
- 页面切换：500ms
- 卡片悬停：200ms
- 面板展开：300ms
- 数据加载：400ms

## 6. 性能优化要求

### 6.1 加载性能
- 首屏加载时间 < 2秒
- 使用代码分割，按需加载视图组件
- 图片使用 Next.js Image 组件优化
- 数据懒加载，只加载当前可见的朝代数据

### 6.2 运行性能
- 动画使用 CSS transform，避免触发重排
- 大数据量使用虚拟滚动
- 防抖处理搜索输入
- 使用 React.memo 优化组件渲染

### 6.3 数据优化
- 朝代数据预加载
- 使用 IndexedDB 缓存用户浏览历史
- 地图数据按需加载

## 7. 可访问性要求

### 7.1 无障碍支持
- 支持键盘导航
- 提供 ARIA 标签
- 支持屏幕阅读器
- 颜色对比度符合 WCAG AA 标准

### 7.2 国际化支持
- 支持中英文切换
- 日期格式本地化
- 数字格式本地化

## 8. 扩展功能（可选）

### 8.1 用户功能
- 收藏喜欢的朝代
- 保存浏览历史
- 导出朝代信息为PDF
- 分享功能

### 8.2 高级功能
- 3D时间轴可视化
- VR/AR模式（未来扩展）
- 历史事件模拟动画
- 朝代关系网络分析

## 9. 开发里程碑

### 阶段1：基础框架（Week 1-2）
- [ ] 项目结构搭建
- [ ] 朝代数据整理和录入
- [ ] 基础UI组件开发
- [ ] 路由和状态管理

### 阶段2：核心视图（Week 3-4）
- [ ] 时间轴视图实现
- [ ] 卡片流视图实现
- [ ] 地图视图实现
- [ ] 关系图视图实现

### 阶段3：交互功能（Week 5-6）
- [ ] 朝代详情面板
- [ ] 搜索和筛选功能
- [ ] 对比功能
- [ ] 视图切换功能

### 阶段4：智能助手（Week 7）
- [ ] AI助手UI开发
- [ ] 助手逻辑实现（可先使用规则引擎，后续接入AI）
- [ ] 对话界面优化

### 阶段5：动效优化（Week 8）
- [ ] 页面动效实现
- [ ] 交互动效优化
- [ ] 数据可视化动效
- [ ] 性能优化

### 阶段6：测试与优化（Week 9-10）
- [ ] 功能测试
- [ ] 性能测试
- [ ] 兼容性测试
- [ ] 用户体验优化
- [ ] 文档完善

## 10. 成功标准

### 10.1 功能完整性
- ✅ 所有主要朝代数据完整
- ✅ 四种视图模式正常工作
- ✅ 智能助手能够回答基本问题
- ✅ 搜索和筛选功能准确

### 10.2 用户体验
- ✅ 界面美观，符合设计规范
- ✅ 交互流畅，无明显卡顿
- ✅ 动画自然，不突兀
- ✅ 响应式设计在各设备上正常显示

### 10.3 性能指标
- ✅ 首屏加载 < 2秒
- ✅ 页面切换 < 500ms
- ✅ 动画帧率 ≥ 60fps
- ✅ 内存占用合理

## 11. 注意事项

### 11.1 历史准确性
- 历史数据需要经过验证，确保准确性
- 对于有争议的历史事件，提供多种观点
- 标注数据来源

### 11.2 文化敏感性
- 尊重历史，避免主观评价
- 使用中性语言描述历史事件
- 避免政治敏感内容

### 11.3 技术考虑
- 考虑浏览器兼容性
- 优化移动端体验
- 考虑网络较慢的情况

---

## 附录：参考资源

### 设计参考
- iOS 26 概念设计（项目内现有demo）
- 历史类应用UI设计
- 数据可视化最佳实践

### 数据来源
- 中国历史年表
- 历史研究资料
- 学术文献

### 技术文档
- Next.js 官方文档
- React 官方文档
- Tailwind CSS 文档
- Framer Motion 文档

---

**文档版本**：v1.0  
**创建日期**：2024年  
**最后更新**：2024年  
**维护者**：开发团队

